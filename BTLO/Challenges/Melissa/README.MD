# ğŸ›¡ï¸ BTLO - Melissa

- **Difficulty:** Easy  
- **Category:** Reverse Engineering
- **Platform:** [Blue Team Labs Online (BTLO)](https://blueteamlabs.online/)  
- **Focus:** TextEditor, Oledump
---

## ğŸ“Œ Scenario

Melissa aka W97M.Melissa.A (Symantec) or Virus:W32/Melissa (F-Secure) is a macro virus dates back to March 26, 1999.
This challenge should be completed in a virtual machine as it contains real malware.

---

![terminalscreen](./melis_screen.jpg)

---

## ğŸ” Step-by-Step

### 1ï¸âƒ£ Submit the stream number that contains the Melissa macro in the `LIST.DOC` file>

> Used `oleid` to inspect the structure of the OLE file. 
> One of the streams was marked as containing VBA macros, and it was clearly indicated as the suspicious stream based on the toolâ€™s output.

### 2ï¸âƒ£ After identifying which version of word, Melissa will enable all macros from registry?

> Opened the file with `olevba` and manually inspected the extracted macro code. 
> Found logic that checks the Word version.

### 3ï¸âƒ£ What is the email service targeted by Melissa?

> Found by analyzing the `any.run` report.

### 4ï¸âƒ£ How many number of email addresses were collected?

> Reviewed the macro script manually via`olevba`.

### 5ï¸âƒ£ What is the string used by melissa to identify whether a PC is infected or not and decide whether to collect email addresses or not?

> Carefully examined the conditional logic in the macro code. 
> Found a string that the virus checks for on the system to determine whether itâ€™s already infected. 

### 6ï¸âƒ£ What is the variable responsible for identifying the email username of the infected PC?

> Searched the macro dump for references to "username" using `grep`.

### 7ï¸âƒ£ What is the text in email body used for spreading melissa ?

> Used `grep` 'body' on the macro output. Found the line responsible for setting the message body in the email that Melissa sends. 

### 8ï¸âƒ£ What is the text that is inserted by Melissa in an open word document?

> Used `grep` 'insert' on the macro output.


---

## ğŸ›  Tools & Techniques Used

- `oleid` â€” for OLE stream and macro detection
- `olevba` â€” for macro extraction and static code analysis
- `any.run` â€” to observe malware behavior in a dynamic environment
- `grep`, `cat` â€” for keyword-based macro navigation
- Manual inspection â€” to interpret VBA code logic

---

## ğŸ§  Notes

- Melissa is a classic example of how simple macro logic can enable mass propagation via email clients.
- Reinfection prevention logic was implemented through file presence checks.
- Address harvesting and propagation logic are embedded directly in the macro using Outlook's object model.
- This challenge improved my skills in:
> - Extracting and interpreting malicious macros
> - Recognizing malware persistence techniques
> - Analyzing VBA structures for email-based worms

---

## ğŸ“‚ Files

- This challenge included a `.doc` (infected).
- No additional attachments.

---

## ğŸ–¼ Certificate

![BTLO ATT&CK certificate](./meliscert.jpg)



## ğŸ§‘â€ğŸ’» Author

**Anton Ivanov**  
Cybersecurity Learner | SOC Analyst in progress  
ğŸ“ Paradise, NL, Canada  
ğŸ“« [keepdsn@icloud.com](mailto:keepdsn@icloud.com)  
ğŸ”— [linkedin.com/in/davniyson](https://linkedin.com/in/davniyson)
