# ğŸ›¡ï¸ BTLO - Malware Analysis - Ransomware Script

- **Difficulty:** Easy  
- **Category:** Reverse Engineering
- **Platform:** [Blue Team Labs Online (BTLO)](https://blueteamlabs.online/)  
- **Focus:** TextEditor
---

## ğŸ“Œ Scenario

One of our web servers recently got compromised and was hit with ransomware. Luckily we had a restore point just before the files were encrypted, and managed to recover a suspicious script file that didn't appear to have been run yet.

![terminal screenshot](./mal_term.jpg)
---

## ğŸ” Step-by-Step

### 1ï¸âƒ£ What is the malicious IP address referenced multiple times in the script?:

> Found using the `strings` command and filtered with `grep -i http`.
> - Method: Looked for hardcoded URLs and IPs in string content.

### 2ï¸âƒ£ The script uses apt-get to retrieve two tools, and uses yum to install them. What is the command line to remove the yum logs afterwards?

> Found using the `strings` command with `grep -i yum`.
> -Method: Located cleanup command following yum installation sections.

### 3ï¸âƒ£ A message is created in the file /etc/motd. What are the three first words?

> Identified using: `cat mal.txt | grep /etc/motd -A 25`
> - Method: Heredoc block writes the full ASCII and ransom message to /etc/motd. The first three words after `<<EOF` are extracted.

### 4ï¸âƒ£ This message also contains a contact email address to have the system fixed. What is it? 

> Found in the same `/etc/motd` block.
> - Method: Email is visible near the end of the ransom message.

### 5ï¸âƒ£ When files are encrypted, an unusual file extension is used. What is it?

> Detected in multiple lines, verified using `hexdump` to examine the raw bytes and `CyberChef` to confirm the symbol rendering.
> - Method: The `.*` (Unicode radioactive sign U+2622) is used as the file extension.

### 6ï¸âƒ£ There are 5 functions associated with the encryption process that start with â€˜encryptâ€™. What are they, in the order theyâ€™re actually executed in the script?

> Identified using: `grep`
> - needs double check the order

### 7ï¸âƒ£ The script will check a text file hosted on the C2 server. What is the full URL of this file?

> Quickly found using `grep`
> - Method: Revealed hardcoded C2 URL pointing to .txt file used to trigger encryption logic.

---

## ğŸ›  Tools & Techniques Used

- cat, grep, strings â€” for exploring script contents
- hexdump, CyberChef â€” to analyze structure and detect Unicode
- Manual function trace and bash flow analysis
- Sandbox virtual machine for safe examination

---

## ğŸ§  Notes

- The script adds a new user, disables others, and encrypts critical file types.
- It uses obfuscated Unicode extensions to hide encrypted files.
- The use of multiple package managers (APT/YUM) increases compatibility across systems.
- Communication with a Telegram bot and C2 infrastructure is implemented.
- The motd file is overwritten with a full-screen ASCII ransom message, including email contact.
- This challenge strengthened my skills in:
> - Bash malware static analysis
> - Detecting obfuscation techniques
> - Understanding script logic and flow

---

## ğŸ“‚ Files

- This challenge involved analyzing a malicious *.txt file.
Note: The original script file is not attached for safety reasons.

---

## ğŸ–¼ Certificate

![BTLO ATT&CK certificate](./malcert.jpg)



## ğŸ§‘â€ğŸ’» Author

**Anton Ivanov**  
Cybersecurity Learner | SOC Analyst in progress  
ğŸ“ Paradise, NL, Canada  
ğŸ“« [keepdsn@icloud.com](mailto:keepdsn@icloud.com)  
ğŸ”— [linkedin.com/in/davniyson](https://linkedin.com/in/davniyson)

